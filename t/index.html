<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>内容查询</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            max-width: 800px;
            margin: 20px auto;
            padding: 0 20px;
        }
        #result {
            white-space: pre-wrap;
            background: #f6f8fa;
            padding: 20px;
            border-radius: 6px;
            margin-top: 20px;
        }
        .error {
            color: #cf222e;
            background: #ffebe9;
            padding: 15px;
            border-radius: 6px;
        }
        a {
            color: #2da44e;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <h1>内容查询</h1>
    <div id="result">加载中...</div>
    <p><a href="/">返回首页</a></p>

    <script>
        // 解析URL参数
        const urlParams = new URLSearchParams(window.location.search);
        const contentId = urlParams.get('id');

        // 显示错误信息
        function showError(message) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = `<div class="error">${message}</div>`;
        }

        // 格式化JSON显示
        function formatJSON(data) {
            return JSON.stringify(data, null, 2)
                .replace(/ /g, '&nbsp;')
                .replace(/\n/g, '<br>');
        }

        // 主加载函数
        async function loadContent() {
            try {
                // 验证ID参数
                if (!contentId) {
                    return showError('缺少ID参数，请使用格式 /t?id=1');
                }
                
                if (isNaN(contentId) || !Number.isInteger(Number(contentId))) {
                    return showError('ID参数必须是整数');
                }

                // 加载数据
                const response = await fetch('../data.json');
                if (!response.ok) {
                    return showError(`数据加载失败 (HTTP ${response.status})`);
                }
                
                const data = await response.json();
                
                // 查找匹配条目
                const item = data.find(d => d.contentid === Number(contentId));
                
                // 显示结果
                const resultDiv = document.getElementById('result');
                if (item) {
                    resultDiv.innerHTML = `
                        <h3>找到 contentid=${contentId} 的内容：</h3>
                        <div>${formatJSON(item)}</div>
                    `;
                } else {
                    showError(`未找到 contentid=${contentId} 的内容`);
                }
            } catch (error) {
                showError(`数据加载失败: ${error.message}`);
            }
        }

        // 页面加载完成后执行
        window.onload = loadContent;
    </script>
</body>
</html>
